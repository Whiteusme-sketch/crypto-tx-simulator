import asyncio
import random
import hashlib
import time

async def propagate_to_node(node, delay):
    await asyncio.sleep(delay)
    timestamp = round(time.time(), 3)
    print(f"{node} получил транзакцию в {timestamp} секунд")

async def simulate_tx_propagation():
    nodes = [f"Узел-{i}" for i in range(1, 6)]
    tx_id = hashlib.sha256(str(time.time()).encode()).hexdigest()
    print(f"ID транзакции: {tx_id}\n")

    tasks = []
    for node in nodes:
        delay = random.uniform(0.01, 1.0)
        tasks.append(propagate_to_node(node, delay))

    await asyncio.gather(*tasks)

if __name__ == "__main__":
    asyncio.run(simulate_tx_propagation())
